version: '2'
image_name: agentic-ai-openai

apis:
  - inference
  - agents
  - files
  - tool_runtime
  - vector_io
  # - safety  # Requires Llama model for llama-guard
  # - telemetry

providers:
  inference:
    - provider_id: openai
      provider_type: remote::openai
      config:
        api_key: ${env.OPENAI_API_KEY}
  agents:
    - provider_id: meta-reference
      provider_type: inline::meta-reference
      config:
        persistence:
          agent_state:
            namespace: agents
            backend: kv_default
          responses:
            table_name: responses
            backend: sql_default
            max_write_queue_size: 10000
            num_writers: 4
  files:
    - provider_id: meta-reference-files
      provider_type: inline::localfs
      config:
        storage_dir: ${env.FILES_STORAGE_DIR:=~/.llama/distributions/agentic-ai-openai/files}
        metadata_store:
          table_name: files_metadata
          backend: sql_default
  vector_io:
    - provider_id: faiss
      provider_type: inline::faiss
      config:
        persistence:
          backend: kv_default
          namespace: vector_io::faiss
  tool_runtime:
    - provider_id: rag-runtime
      provider_type: inline::rag-runtime
      config: {}

storage:
  backends:
    kv_default:
      type: kv_sqlite
      db_path: ${env.SQLITE_STORE_DIR:=~/.llama/distributions/agentic-ai-openai}/kvstore.db
    sql_default:
      type: sql_sqlite
      db_path: ${env.SQLITE_STORE_DIR:=~/.llama/distributions/agentic-ai-openai}/sqlstore.db
  stores:
    metadata:
      namespace: registry
      backend: kv_default
    inference:
      table_name: inference_store
      backend: sql_default
    conversations:
      table_name: openai_conversations
      backend: sql_default
    prompts:
      namespace: prompts
      backend: kv_default

models:
  - model_id: gpt-4o
    provider_id: openai
    provider_model_id: gpt-4o
    model_type: llm
  - model_id: gpt-4o-mini
    provider_id: openai
    provider_model_id: gpt-4o-mini
    model_type: llm

server:
  port: 8321
